<% if !defined?(actoresdisp)  %>
  <% actoresdisp = Sip::Actorsocial.habilitados %>
<% end %>
<% a1 = Sip::Actorsocial.habilitados %>
<% lg = [] %>
<% lg += @params[:actividad][:grupo_ids] if @params[:actividad][:grupo_ids] %>
<% a1 = Sip::ActoressocialesController::filtra_grupos_fecha(
  a1, lg-[""], @params[:actividad][:fecha_localizada]) %>
<% a1l = a1.map(&:id) + @params[:actividad][:actorsocial_ids] %>
<% a2 = actoresdisp.joins(:grupoper).where(id: a1l).
  order('sip_grupoper.nombre') %>
<% lids = actoresdisp.map(&:id) %>
<% a2 = Sip::Actorsocial.joins(:grupoper).where(id: lids).
  order('sip_grupoper.nombre') %>
  valores = $("#actividad_actorsocial_ids").val();
<% if @params[:action] == "nuevo_actorsocial_modal" %>
  $("#actividad_actorsocial_ids").html('<%= escape_javascript options_from_collection_for_select(a2, "id", "presenta_nombre") %>');
  valor = $.merge([<%= @params[:id_nuevoactor]%>], valores); 
  $("#actividad_actorsocial_ids").val(valor);
  $("#actividad_actorsocial_ids").trigger("chosen:updated");
<% end %>
